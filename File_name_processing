import os
import unicodedata

# Đường dẫn thư mục bạn muốn đổi tên các file
folder_path = 'C:\\Users\\FPT\\PyCharmMiscProject\\bien_bao_cam'  # Thay đổi đường dẫn này cho phù hợp

# Lấy danh sách tất cả các file trong thư mục
for filename in os.listdir(folder_path):
    # Tạo đường dẫn đầy đủ đến file
    old_file_path = os.path.join(folder_path, filename)

    # Kiểm tra xem đó có phải là file không (bỏ qua thư mục)
    if os.path.isfile(old_file_path):
        # Chuyển tên file thành không phải Unicode và thay dấu cách thành dấu _
        normalized_filename = unicodedata.normalize('NFKD', filename).encode('ascii', 'ignore').decode('utf-8')
        new_filename = normalized_filename.replace(' ', '_')  # Thay dấu cách bằng dấu gạch dưới

        # Tạo đường dẫn mới
        new_file_path = os.path.join(folder_path, new_filename)

        # Đổi tên file
        os.rename(old_file_path, new_file_path)

        print(f"Đã đổi tên file: {filename} -> {new_filename}")
